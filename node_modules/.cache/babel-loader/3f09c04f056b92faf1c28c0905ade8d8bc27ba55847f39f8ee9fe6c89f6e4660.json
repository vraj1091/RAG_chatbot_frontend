{"ast":null,"code":"import React,{useState,useEffect}from'react';import{apiService}from'../services/apiService.js';import LoadingSpinner from'../components/LoadingSpinner.jsx';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function KnowledgeBase(){const[documents,setDocuments]=useState([]);const[stats,setStats]=useState(null);const[loading,setLoading]=useState(true);const[uploading,setUploading]=useState(false);useEffect(()=>{loadKnowledgeBase();},[]);const loadKnowledgeBase=async()=>{try{setLoading(true);const[documentsData,statsData]=await Promise.all([apiService.getDocuments(),apiService.getDocumentStats()]);setDocuments(documentsData);setStats(statsData);}catch(err){console.error('Failed to load knowledge base:',err);toast.error('Failed to load knowledge base');}finally{setLoading(false);}};const handleFileUpload=async event=>{const files=Array.from(event.target.files);if(files.length===0)return;for(const file of files){setUploading(true);try{const response=await apiService.uploadDocument(file);setDocuments(prev=>[response.document,...prev]);toast.success(\"\".concat(file.name,\" uploaded successfully!\"));const updatedStats=await apiService.getDocumentStats();setStats(updatedStats);}catch(err){console.error('Upload failed:',err);toast.error(\"Failed to upload \".concat(file.name));}finally{setUploading(false);}}event.target.value='';// Reset file input\n};const deleteDocument=async(documentId,filename)=>{if(!window.confirm(\"Delete \\\"\".concat(filename,\"\\\"?\")))return;try{await apiService.deleteDocument(documentId);setDocuments(prev=>prev.filter(doc=>doc.id!==documentId));toast.success('Document deleted successfully');const updatedStats=await apiService.getDocumentStats();setStats(updatedStats);}catch(err){toast.error('Failed to delete document');}};const getStatusIcon=status=>{switch(status){case'completed':return'âœ…';case'processing':return'â³';case'failed':return'âŒ';default:return'â¸ï¸';}};const formatFileSize=bytes=>{const k=1024;const sizes=['Bytes','KB','MB','GB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i];};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"large\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold text-gray-900 flex items-center\",children:[\"\\uD83D\\uDCDA Knowledge Base (\",documents.length,\" documents)\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-1\",children:\"Manage your AI knowledge base files - upload, view, and delete documents\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-6xl mb-4 block\",children:\"\\uD83D\\uDCE4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Upload documents to knowledge base\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:\"Supports PDF, DOCX, TXT, and image files (PNG, JPG)\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"btn-primary cursor-pointer inline-flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\".pdf,.txt,.docx,.png,.jpg,.jpeg\",onChange:handleFileUpload,disabled:uploading,className:\"hidden\"}),uploading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\",color:\"white\",className:\"mr-2\"}),\"Uploading...\"]}):'ðŸ“ Choose Files']}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:\"Maximum file size: 25MB\"})]})}),documents.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Your Documents\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 p-6\",children:documents.map(document=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mr-3\",children:document.document_type==='image'?'ðŸ–¼ï¸':'ðŸ“„'}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 truncate max-w-md\",children:document.original_filename}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[document.file_type.toUpperCase(),\" \\u2022 \",formatFileSize(document.file_size),\" \\u2022 \",getStatusIcon(document.processing_status),\" \",document.processing_status]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteDocument(document.id,document.original_filename),className:\"text-red-600 hover:text-red-800 p-2\",title:\"Delete document\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]},document.id))})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-6xl mb-4 block\",children:\"\\uD83D\\uDCDA\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"No documents in your knowledge base\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-6\",children:\"Upload your first document to start building your AI-powered knowledge base.\"})]})]});}export default KnowledgeBase;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}