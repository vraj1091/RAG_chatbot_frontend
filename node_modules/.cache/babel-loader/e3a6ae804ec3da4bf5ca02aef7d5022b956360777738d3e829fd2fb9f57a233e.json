{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{apiService}from'../services/apiService.js';import LoadingSpinner from'../components/LoadingSpinner.jsx';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Chat(){const[messages,setMessages]=useState([]);const[currentMessage,setCurrentMessage]=useState('');const[conversations,setConversations]=useState([]);const[currentConversation,setCurrentConversation]=useState(null);const[loading,setLoading]=useState(false);const[conversationsLoading,setConversationsLoading]=useState(true);const[chatMode,setChatMode]=useState('rag');// default to RAG mode\nconst messagesEndRef=useRef(null);useEffect(()=>{loadConversations();},[]);useEffect(()=>{scrollToBottom();},[messages]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const loadConversations=async()=>{try{setConversationsLoading(true);const data=await apiService.getConversations();setConversations(data);if(data.length===0)setChatMode('general');// No docs -> set general mode\n}catch(err){toast.error('Failed to load chat history');}finally{setConversationsLoading(false);}};const loadConversation=async conversationId=>{try{setLoading(true);const messages=await apiService.getConversationMessages(conversationId);setCurrentConversation(conversations.find(c=>c.id===conversationId));setMessages(messages);}catch(err){toast.error('Failed to load conversation');}finally{setLoading(false);}};const sendMessage=async e=>{e.preventDefault();if(!currentMessage.trim()||loading)return;const userMessage=currentMessage.trim();setCurrentMessage('');setLoading(true);const tempMessage={id:\"temp-\".concat(Date.now()),role:'user',content:userMessage,created_at:new Date().toISOString()};setMessages(prev=>[...prev,tempMessage]);try{// Pass chatMode as query param 'mode' to backend\nconst response=await apiService.sendMessage(userMessage,currentConversation===null||currentConversation===void 0?void 0:currentConversation.id,chatMode);setMessages(prev=>prev.filter(msg=>msg.id!==tempMessage.id));const newMessages=[{id:\"user-\".concat(Date.now()),role:'user',content:userMessage,created_at:new Date().toISOString()},{id:\"assistant-\".concat(Date.now()),role:'assistant',content:response.message,sources:response.sources||[],created_at:new Date().toISOString(),context_used:response.context_used}];setMessages(prev=>[...prev,...newMessages]);if(!currentConversation||currentConversation.id!==response.conversation_id){setCurrentConversation({id:response.conversation_id,title:userMessage.substring(0,50)+(userMessage.length>50?'...':'')});await loadConversations();}}catch(err){toast.error('Failed to send message');setMessages(prev=>prev.filter(msg=>msg.id!==tempMessage.id));}finally{setLoading(false);}};const startNewConversation=()=>{setCurrentConversation(null);setMessages([]);};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 h-[calc(100vh-8rem)] flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-80 border-r border-gray-200 flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"\\uD83D\\uDCAC Chat History\"}),/*#__PURE__*/_jsx(\"button\",{onClick:startNewConversation,className:\"w-full mt-3 btn-primary\",children:\"\\u2795 New Chat\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 px-3 py-1 rounded \".concat(chatMode==='general'?'bg-primary-600 text-white':'bg-gray-100 text-gray-700'),onClick:()=>setChatMode('general'),children:\"General Chat\"}),/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 px-3 py-1 rounded \".concat(chatMode==='rag'?'bg-primary-600 text-white':'bg-gray-100 text-gray-700',\" \").concat(conversations.length===0?'opacity-50 cursor-not-allowed':''),onClick:()=>conversations.length>0&&setChatMode('rag'),disabled:conversations.length===0,title:conversations.length===0?'Upload documents to enable RAG mode':'',children:\"Document Chat\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto\",children:conversationsLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 text-center\",children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"medium\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-2\",children:\"Loading...\"})]}):conversations.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"p-2\",children:conversations.map(conversation=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 mb-2 rounded-lg cursor-pointer transition-colors \".concat((currentConversation===null||currentConversation===void 0?void 0:currentConversation.id)===conversation.id?'bg-primary-50 border-l-4 border-primary-500':'hover:bg-gray-50'),onClick:()=>loadConversation(conversation.id),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900 truncate\",children:conversation.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:formatDate(conversation.created_at)})]},conversation.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-full p-4 text-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl mb-3\",children:\"\\uD83D\\uDCAC\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"No chat history yet\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b border-gray-200 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900 flex items-center\",children:[\"\\u2728 \",currentConversation?currentConversation.title:'AI RAG Chat']}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:[messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-full text-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:chatMode==='rag'?'Start a RAG conversation':'Start a general chat'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 max-w-sm mb-6\",children:chatMode==='rag'?'Ask questions about your uploaded documents.':'Chat freely without document context.'})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[messages.map(message=>/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(message.role==='user'?'justify-end':'justify-start'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xs lg:max-w-md px-4 py-3 rounded-2xl \".concat(message.role==='user'?'bg-primary-600 text-white ml-auto':'bg-gray-100 text-gray-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm leading-relaxed whitespace-pre-wrap\",children:message.content}),message.role==='assistant'&&message.context_used&&chatMode==='rag'&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-xs text-primary-600 flex items-center\",children:\"\\u2728 Answered using knowledge base\"}),message.role==='assistant'&&message.sources&&message.sources.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 pt-3 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 mb-2\",children:\"\\uD83D\\uDCC4 Sources:\"}),message.sources.slice(0,2).map((source,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 bg-gray-50 p-2 rounded mb-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:source.filename}),source.similarity_score&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-primary-600\",children:[Math.round(source.similarity_score*100),\"% match\"]})]},index))]})]})},message.id)),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 px-4 py-3 rounded-2xl\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\"})})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 p-4 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendMessage,className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:currentMessage,onChange:e=>setCurrentMessage(e.target.value),placeholder:chatMode==='rag'?\"Ask me anything about your documents...\":\"Chat freely without documents...\",className:\"flex-1 input-field\",disabled:loading}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading||!currentMessage.trim(),className:\"btn-primary px-4 disabled:opacity-50\",children:loading?/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\",color:\"white\"}):'ðŸš€'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between mt-2 text-xs text-gray-500\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCA1 Tip: Upload documents in Knowledge Base to get better answers\"})})]})]})]});}export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","apiService","LoadingSpinner","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chat","messages","setMessages","currentMessage","setCurrentMessage","conversations","setConversations","currentConversation","setCurrentConversation","loading","setLoading","conversationsLoading","setConversationsLoading","chatMode","setChatMode","messagesEndRef","loadConversations","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","data","getConversations","length","err","error","loadConversation","conversationId","getConversationMessages","find","c","id","sendMessage","e","preventDefault","trim","userMessage","tempMessage","concat","Date","now","role","content","created_at","toISOString","prev","response","filter","msg","newMessages","message","sources","context_used","conversation_id","title","substring","startNewConversation","formatDate","dateString","toLocaleDateString","month","day","hour","minute","className","children","onClick","disabled","size","map","conversation","slice","source","index","filename","similarity_score","Math","round","ref","onSubmit","type","value","onChange","target","placeholder","color"],"sources":["C:/Users/vrajr/Downloads/ai-rag-chatbot-python/ai-rag-chatbot-python/frontend/src/pages/Chat.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { apiService } from '../services/apiService.js';\nimport LoadingSpinner from '../components/LoadingSpinner.jsx';\nimport toast from 'react-hot-toast';\n\nfunction Chat() {\n  const [messages, setMessages] = useState([]);\n  const [currentMessage, setCurrentMessage] = useState('');\n  const [conversations, setConversations] = useState([]);\n  const [currentConversation, setCurrentConversation] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [conversationsLoading, setConversationsLoading] = useState(true);\n  const [chatMode, setChatMode] = useState('rag'); // default to RAG mode\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    loadConversations();\n  }, []);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const loadConversations = async () => {\n    try {\n      setConversationsLoading(true);\n      const data = await apiService.getConversations();\n      setConversations(data);\n      if (data.length === 0) setChatMode('general'); // No docs -> set general mode\n    } catch (err) {\n      toast.error('Failed to load chat history');\n    } finally {\n      setConversationsLoading(false);\n    }\n  };\n\n  const loadConversation = async (conversationId) => {\n    try {\n      setLoading(true);\n      const messages = await apiService.getConversationMessages(conversationId);\n      setCurrentConversation(conversations.find(c => c.id === conversationId));\n      setMessages(messages);\n    } catch (err) {\n      toast.error('Failed to load conversation');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const sendMessage = async (e) => {\n    e.preventDefault();\n    if (!currentMessage.trim() || loading) return;\n\n    const userMessage = currentMessage.trim();\n    setCurrentMessage('');\n    setLoading(true);\n\n    const tempMessage = {\n      id: `temp-${Date.now()}`,\n      role: 'user',\n      content: userMessage,\n      created_at: new Date().toISOString()\n    };\n    setMessages(prev => [...prev, tempMessage]);\n\n    try {\n      // Pass chatMode as query param 'mode' to backend\n      const response = await apiService.sendMessage(userMessage, currentConversation?.id, chatMode);\n\n      setMessages(prev => prev.filter(msg => msg.id !== tempMessage.id));\n\n      const newMessages = [\n        {\n          id: `user-${Date.now()}`,\n          role: 'user',\n          content: userMessage,\n          created_at: new Date().toISOString()\n        },\n        {\n          id: `assistant-${Date.now()}`,\n          role: 'assistant',\n          content: response.message,\n          sources: response.sources || [],\n          created_at: new Date().toISOString(),\n          context_used: response.context_used\n        }\n      ];\n\n      setMessages(prev => [...prev, ...newMessages]);\n\n      if (!currentConversation || currentConversation.id !== response.conversation_id) {\n        setCurrentConversation({ \n          id: response.conversation_id,\n          title: userMessage.substring(0, 50) + (userMessage.length > 50 ? '...' : '')\n        });\n        await loadConversations();\n      }\n\n    } catch (err) {\n      toast.error('Failed to send message');\n      setMessages(prev => prev.filter(msg => msg.id !== tempMessage.id));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const startNewConversation = () => {\n    setCurrentConversation(null);\n    setMessages([]);\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 h-[calc(100vh-8rem)] flex\">\n      {/* Conversations Sidebar */}\n      <div className=\"w-80 border-r border-gray-200 flex flex-col\">\n        <div className=\"p-4 border-b border-gray-200\">\n          <h2 className=\"text-lg font-semibold text-gray-900\">ðŸ’¬ Chat History</h2>\n          <button onClick={startNewConversation} className=\"w-full mt-3 btn-primary\">\n            âž• New Chat\n          </button>\n        </div>\n\n        <div className=\"p-4 flex space-x-2\">\n          {/* Mode toggle buttons */}\n          <button\n            className={`flex-1 px-3 py-1 rounded ${\n              chatMode === 'general' ? 'bg-primary-600 text-white' : 'bg-gray-100 text-gray-700'\n            }`}\n            onClick={() => setChatMode('general')}\n          >\n            General Chat\n          </button>\n          <button\n            className={`flex-1 px-3 py-1 rounded ${\n              chatMode === 'rag' ? 'bg-primary-600 text-white' : 'bg-gray-100 text-gray-700'\n            } ${conversations.length === 0 ? 'opacity-50 cursor-not-allowed' : ''}`}\n            onClick={() => conversations.length > 0 && setChatMode('rag')}\n            disabled={conversations.length === 0}\n            title={conversations.length === 0 ? 'Upload documents to enable RAG mode' : ''}\n          >\n            Document Chat\n          </button>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto\">\n          {conversationsLoading ? (\n            <div className=\"p-4 text-center\">\n              <LoadingSpinner size=\"medium\" />\n              <p className=\"text-sm text-gray-500 mt-2\">Loading...</p>\n            </div>\n          ) : conversations.length > 0 ? (\n            <div className=\"p-2\">\n              {conversations.map((conversation) => (\n                <div\n                  key={conversation.id}\n                  className={`p-3 mb-2 rounded-lg cursor-pointer transition-colors ${\n                    currentConversation?.id === conversation.id ? 'bg-primary-50 border-l-4 border-primary-500' : 'hover:bg-gray-50'\n                  }`}\n                  onClick={() => loadConversation(conversation.id)}\n                >\n                  <p className=\"text-sm font-medium text-gray-900 truncate\">{conversation.title}</p>\n                  <p className=\"text-xs text-gray-500\">{formatDate(conversation.created_at)}</p>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"flex flex-col items-center justify-center h-full p-4 text-center\">\n              <span className=\"text-4xl mb-3\">ðŸ’¬</span>\n              <p className=\"text-gray-500 text-sm\">No chat history yet</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Chat Area */}\n      <div className=\"flex-1 flex flex-col\">\n        <div className=\"p-4 border-b border-gray-200 bg-gray-50\">\n          <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n            âœ¨ {currentConversation ? currentConversation.title : 'AI RAG Chat'}\n          </h3>\n          <p className=\"text-sm text-gray-500\"></p>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n          {messages.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center h-full text-center\">\n\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                {chatMode === 'rag' ? 'Start a RAG conversation' : 'Start a general chat'}\n              </h3>\n              <p className=\"text-gray-500 max-w-sm mb-6\">\n                {chatMode === 'rag'\n                  ? 'Ask questions about your uploaded documents.'\n                  : 'Chat freely without document context.'}\n              </p>\n            </div>\n          ) : (\n            <>\n              {messages.map((message) => (\n                <div key={message.id} className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                  <div\n                    className={`max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ${\n                      message.role === 'user'\n                        ? 'bg-primary-600 text-white ml-auto'\n                        : 'bg-gray-100 text-gray-900'\n                    }`}\n                  >\n                    <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{message.content}</p>\n\n                    {message.role === 'assistant' && message.context_used && chatMode === 'rag' && (\n                      <div className=\"mt-2 text-xs text-primary-600 flex items-center\">\n                        âœ¨ Answered using knowledge base\n                      </div>\n                    )}\n\n                    {message.role === 'assistant' && message.sources && message.sources.length > 0 && (\n                      <div className=\"mt-3 pt-3 border-t border-gray-200\">\n                        <p className=\"text-xs text-gray-600 mb-2\">ðŸ“„ Sources:</p>\n                        {message.sources.slice(0, 2).map((source, index) => (\n                          <div key={index} className=\"text-xs text-gray-500 bg-gray-50 p-2 rounded mb-1\">\n                            <div className=\"font-medium\">{source.filename}</div>\n                            {source.similarity_score && (\n                              <div className=\"text-primary-600\">{Math.round(source.similarity_score * 100)}% match</div>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))}\n              {loading && (\n                <div className=\"flex justify-start\">\n                  <div className=\"bg-gray-100 px-4 py-3 rounded-2xl\">\n                    <LoadingSpinner size=\"small\" />\n                  </div>\n                </div>\n              )}\n            </>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n\n        <div className=\"border-t border-gray-200 p-4 bg-gray-50\">\n          <form onSubmit={sendMessage} className=\"flex items-center space-x-3\">\n            <input\n              type=\"text\"\n              value={currentMessage}\n              onChange={(e) => setCurrentMessage(e.target.value)}\n              placeholder={chatMode === 'rag' ? \"Ask me anything about your documents...\" : \"Chat freely without documents...\"}\n              className=\"flex-1 input-field\"\n              disabled={loading}\n            />\n            <button\n              type=\"submit\"\n              disabled={loading || !currentMessage.trim()}\n              className=\"btn-primary px-4 disabled:opacity-50\"\n            >\n              {loading ? <LoadingSpinner size=\"small\" color=\"white\" /> : 'ðŸš€'}\n            </button>\n          </form>\n\n          <div className=\"flex items-center justify-between mt-2 text-xs text-gray-500\">\n            <span>ðŸ’¡ Tip: Upload documents in Knowledge Base to get better answers</span>\n            \n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Chat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}