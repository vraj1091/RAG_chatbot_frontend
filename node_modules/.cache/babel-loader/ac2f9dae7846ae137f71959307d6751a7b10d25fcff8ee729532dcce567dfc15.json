{"ast":null,"code":"import _objectSpread from\"C:/Users/vrajr/Downloads/ai-rag-chatbot-python/ai-rag-chatbot-python/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,Suspense,lazy}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import{Toaster}from'react-hot-toast';import{AuthProvider,useAuth}from'./contexts/AuthContext.jsx';// Lazy load pages and components\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=/*#__PURE__*/lazy(()=>import('./pages/Login.jsx'));const Register=/*#__PURE__*/lazy(()=>import('./pages/Register.jsx'));const Dashboard=/*#__PURE__*/lazy(()=>import('./pages/Dashboard.jsx'));const KnowledgeBase=/*#__PURE__*/lazy(()=>import('./pages/KnowledgeBase.jsx'));const Chat=/*#__PURE__*/lazy(()=>import('./pages/Chat.jsx'));const Layout=/*#__PURE__*/lazy(()=>import('./components/Layout.jsx'));const LoadingSpinner=/*#__PURE__*/lazy(()=>import('./components/LoadingSpinner.jsx'));function ProtectedRoute(_ref){let{children}=_ref;const{isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"large\"})})});}return isAuthenticated?children:/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}function PublicRoute(_ref2){let{children}=_ref2;const{isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"large\"})})});}return isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true}):children;}function App(){const[darkMode,setDarkMode]=useState(()=>{const saved=localStorage.getItem('darkMode');if(saved!==null)return saved==='true';return window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches;});const[modelStatus,setModelStatus]=useState({loaded:false,loading:false,status:'not_loaded'});useEffect(()=>{if(darkMode){document.documentElement.classList.add('dark');}else{document.documentElement.classList.remove('dark');}localStorage.setItem('darkMode',darkMode);},[darkMode]);useEffect(()=>{const checkModelStatus=async()=>{try{const response=await fetch('/api/model/status');const status=await response.json();setModelStatus(status);}catch(err){console.error('Failed to fetch model status',err);}};checkModelStatus();},[]);const preloadModel=async()=>{if(modelStatus.loaded||modelStatus.loading)return;try{setModelStatus(prev=>_objectSpread(_objectSpread({},prev),{},{loading:true}));const response=await fetch('/api/model/preload',{method:'POST'});const result=await response.json();if(result.status==='loading_started'){const poll=setInterval(async()=>{const statusResp=await fetch('/api/model/status');const status=await statusResp.json();setModelStatus(status);if(status.loaded){clearInterval(poll);}},1000);}}catch(err){console.error('Failed to preload model',err);setModelStatus(prev=>_objectSpread(_objectSpread({},prev),{},{loading:false}));}};const DarkModeToggle=()=>/*#__PURE__*/_jsx(\"button\",{className:\"ml-4 px-3 py-1 rounded border border-gray-600 dark:border-gray-300 text-sm\",onClick:()=>setDarkMode(!darkMode),\"aria-label\":\"Toggle dark mode\",type:\"button\",children:darkMode?'üåô Dark':'‚òÄÔ∏è Light'});return/*#__PURE__*/_jsx(\"div\",{className:\"App min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100\",children:/*#__PURE__*/_jsxs(AuthProvider,{children:[/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"large\"})}),children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(Login,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(Register,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{extraHeaderRight:/*#__PURE__*/_jsx(DarkModeToggle,{}),children:/*#__PURE__*/_jsx(Dashboard,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/knowledge-base\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{extraHeaderRight:/*#__PURE__*/_jsx(DarkModeToggle,{}),children:/*#__PURE__*/_jsx(KnowledgeBase,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Layout,{extraHeaderRight:/*#__PURE__*/_jsx(DarkModeToggle,{}),modelStatus:modelStatus,preloadModel:preloadModel,children:/*#__PURE__*/_jsx(Chat,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true})})]})})}),/*#__PURE__*/_jsx(Toaster,{position:\"top-right\",toastOptions:{duration:4000,style:{background:'#363636',color:'#fff'},success:{duration:3000,iconTheme:{primary:'#22c55e',secondary:'#fff'}},error:{duration:5000,iconTheme:{primary:'#ef4444',secondary:'#fff'}}}})]})});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}